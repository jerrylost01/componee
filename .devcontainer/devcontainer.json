{
  "name": "Custom VNC Desktop (zrok)",
  "image": "mcr.microsoft.com/devcontainers/base:ubuntu",

  "features": {
    "ghcr.io/devcontainers/features/desktop-lite:1": {
      "password": "codespace",
      "webPort": "6080"
    }
  },

  "forwardPorts": [6080],
  "portsAttributes": {
    "6080": {
      "label": "Desktop (Web)"
    }
  },

  "postCreateCommand": "sudo apt-get update && \
    sudo apt-get install -y wget pcmanfm && \
    wget https://github.com/openziti/zrok/releases/download/v0.4.23/zrok_0.4.23_linux_amd64.tar.gz -O zrok.tar.gz && \
    sudo tar -xvzf zrok.tar.gz -C /usr/local/bin && \
    sudo mkdir -p /usr/share/backgrounds && \
    sudo wget https://images.pexels.com/photos/1766838/pexels-photo-1766838.jpeg -O /usr/share/backgrounds/codespace-wallpaper.jpeg && \
    wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb && \
    sudo apt install -y ./google-chrome-stable_current_amd64.deb && \
    mkdir -p /home/codespace/.fluxbox && \
    echo 'pcmanfm --desktop &' >> /home/codespace/.fluxbox/startup && \
    echo 'sleep 2 && pcmanfm --set-wallpaper=/usr/share/backgrounds/codespace-wallpaper.jpeg &' >> /home/codespace/.fluxbox/startup && \
    mkdir -p /home/codespace/Desktop && \
    cp /usr/share/applications/google-chrome.desktop /home/codespace/Desktop/"
}
